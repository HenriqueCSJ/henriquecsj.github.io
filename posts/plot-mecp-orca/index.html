<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Plotting molecular electrostatic potential surfaces (MEPS) with ORCA" /><meta name="author" content="Henrique" /><meta property="og:locale" content="en" /><meta name="description" content="It was pissing me off how hard it is to plot decent Molecular Electrostatic Potentials using ORCA and that’s why I’m posting this (so you too don’t have to be pissed off)." /><meta property="og:description" content="It was pissing me off how hard it is to plot decent Molecular Electrostatic Potentials using ORCA and that’s why I’m posting this (so you too don’t have to be pissed off)." /><link rel="canonical" href="https://henriquecsj.github.io/posts/plot-mecp-orca/" /><meta property="og:url" content="https://henriquecsj.github.io/posts/plot-mecp-orca/" /><meta property="og:site_name" content="Henrique’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-06-01T04:36:00-03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Plotting molecular electrostatic potential surfaces (MEPS) with ORCA" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Henrique"},"dateModified":"2023-06-01T16:38:20-03:00","datePublished":"2023-06-01T04:36:00-03:00","description":"It was pissing me off how hard it is to plot decent Molecular Electrostatic Potentials using ORCA and that’s why I’m posting this (so you too don’t have to be pissed off).","headline":"Plotting molecular electrostatic potential surfaces (MEPS) with ORCA","mainEntityOfPage":{"@type":"WebPage","@id":"https://henriquecsj.github.io/posts/plot-mecp-orca/"},"url":"https://henriquecsj.github.io/posts/plot-mecp-orca/"}</script><title>Plotting molecular electrostatic potential surfaces (MEPS) with ORCA | Henrique's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Henrique's Blog"><meta name="application-name" content="Henrique's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="https://raw.githubusercontent.com/HenriqueCSJ/henriquecsj.github.io/main/_images/avatar/hbar.svg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><h1 class="site-title"> <a href="/">Henrique's Blog</a></h1><p class="site-subtitle fst-italic mb-0">Lots of bits</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/HenriqueCSJ" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['henrique.junior','ufrgs.br'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Plotting molecular electrostatic potential surfaces (MEPS) with ORCA</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Plotting molecular electrostatic potential surfaces (MEPS) with ORCA</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1685604960" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 1, 2023 </time> </span> <span> Updated <time data-ts="1685648300" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 1, 2023 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href=""></a> </em> </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1053 words" > <em>5 min</em> read</span></div></div></header><div class="content"><p>It was pissing me off how hard it is to plot decent Molecular Electrostatic Potentials using ORCA and that’s why I’m posting this (so you too don’t have to be pissed off).</p><p>First of all, ORCA does have a utility to plot MEPS for you, it is called <strong>orca_vpot</strong>. It is nicely described on chapter 9.46.10 of the <strong>ORCA 5.0.3</strong> manual and in the <a href="https://sites.google.com/site/orcainputlibrary/orbital-and-density-analysis#h.38v3bl91cggu">ORCA Input Library</a>. The command to get the potentials is not difficult: you need the <strong>gbw</strong> (orca always gives you this), the <strong>scfp</strong> densities (you may request it to be kept with <code class="language-plaintext highlighter-rouge">! KeepDens</code>), the surfaces to which the potentials will be mapped to (<strong>vpot.xyz</strong>) and the output <strong>vpot.out</strong>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>orca_vpot filename.gbw filename.scfp filename.vpot.xyz filename.vpot.out
</pre></table></code></div></div><p>The <em>gbw</em>, <em>scfp</em> and <em>out</em> files are straightforward; but the surface (vpot.xyz) is complicated to get. Luckily there is a python script to help with that part, provided by <a href="https://gist.github.com/mretegan/5501553">Marius Retegan here</a>. I’m preserving the script below but go and say thank you to Marius for his work.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
</pre><td class="rouge-code"><pre><span class="sh">"""</span><span class="s">
(c) 2013, 2019 Marius Retegan

License: BSD-2-Clause

Description: Create a .cube file of the moleclar electrostatic
             potential (MEP) using ORCA.

Run: python mep.py basename npoints (e.g. python mep.py water 40).

Arguments: basename - file name without the extension;
                      this should be the same for the .gbw and .scfp.
           npoints  - number of grid points per side
                      (80 should be fine)
</span><span class="sh">"""</span>

<span class="c1">#!/usr/bin/env python
</span>

<span class="k">def</span> <span class="nf">read_xyz</span><span class="p">(</span><span class="n">xyz</span><span class="p">):</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>
    <span class="n">z</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>

    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="c1"># Skip the first two lines.
</span>        <span class="nf">next</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="nf">next</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">split</span><span class="p">()</span>
            <span class="n">atoms</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">x</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">y</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">z</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">read_vpot</span><span class="p">(</span><span class="n">vpot</span><span class="p">):</span>
    <span class="n">v</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>

    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">vpot</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="nf">next</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="nf">split</span><span class="p">()</span>
            <span class="n">v</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="kn">import</span> <span class="n">os</span>
    <span class="kn">import</span> <span class="n">sys</span>
    <span class="kn">import</span> <span class="n">subprocess</span>
    <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

    <span class="n">ang_to_au</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">0.5291772083</span>

    <span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">H</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">He</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Li</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Be</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">N</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">O</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ne</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Na</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mg</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Al</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Si</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">P</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">S</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Cl</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ar</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">K</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ca</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Sc</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ti</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">V</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Cr</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mn</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Fe</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Co</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ni</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Cu</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Zn</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Ga</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ge</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">As</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Se</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Br</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Kr</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Rb</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Sr</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Y</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Zr</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Nb</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mo</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Tc</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ru</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Rh</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Pd</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ag</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Cd</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">In</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Sn</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Sb</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Te</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">I</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Xe</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Cs</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ba</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">La</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ce</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Pr</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Nd</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Pm</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Sm</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Eu</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Gd</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Tb</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Dy</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ho</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Er</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Tm</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Yb</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Lu</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Hf</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ta</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">W</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Re</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Os</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ir</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Pt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Au</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Hg</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Tl</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Pb</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Bi</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Po</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">At</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Rn</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Fr</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ra</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Ac</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Th</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Pa</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">U</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Np</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Pu</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Am</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Cm</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Bk</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Cf</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Es</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Fm</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Md</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">No</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">Lr</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Rf</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Db</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Sg</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Bh</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Hs</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mt</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Ds</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Rg</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Uub</span><span class="sh">'</span><span class="p">]</span>

    <span class="n">basename</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">xyz</span> <span class="o">=</span> <span class="n">basename</span> <span class="o">+</span> <span class="sh">'</span><span class="s">.xyz</span><span class="sh">'</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">isfile</span><span class="p">(</span><span class="n">xyz</span><span class="p">):</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="sh">'</span><span class="s">Could not find the .xyz. To quickly generate one for </span><span class="sh">'</span>
                 <span class="sh">'</span><span class="s">your molecule run: echo 11 | orca_plot {}.gbw -i.</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">basename</span><span class="p">))</span>

    <span class="n">atoms</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="nf">read_xyz</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">npoints</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="sh">'</span><span class="s">Invalid number of points: {}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

    <span class="n">natoms</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>

    <span class="n">extent</span> <span class="o">=</span> <span class="mf">7.0</span>
    <span class="n">xmin</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="nf">min</span><span class="p">()</span> <span class="o">*</span> <span class="n">ang_to_au</span> <span class="o">-</span> <span class="n">extent</span>
    <span class="n">xmax</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="nf">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">ang_to_au</span> <span class="o">+</span> <span class="n">extent</span>
    <span class="n">ymin</span> <span class="o">=</span> <span class="n">y</span><span class="p">.</span><span class="nf">min</span><span class="p">()</span> <span class="o">*</span> <span class="n">ang_to_au</span> <span class="o">-</span> <span class="n">extent</span>
    <span class="n">ymax</span> <span class="o">=</span> <span class="n">y</span><span class="p">.</span><span class="nf">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">ang_to_au</span> <span class="o">+</span> <span class="n">extent</span>
    <span class="n">zmin</span> <span class="o">=</span> <span class="n">z</span><span class="p">.</span><span class="nf">min</span><span class="p">()</span> <span class="o">*</span> <span class="n">ang_to_au</span> <span class="o">-</span> <span class="n">extent</span>
    <span class="n">zmax</span> <span class="o">=</span> <span class="n">z</span><span class="p">.</span><span class="nf">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">ang_to_au</span> <span class="o">+</span> <span class="n">extent</span>

    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">basename</span> <span class="o">+</span> <span class="sh">'</span><span class="s">_mep.inp</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">fp</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="s">{0:d}</span><span class="se">\n</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">npoints</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="bp">True</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">iy</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="bp">True</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">iz</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="bp">True</span><span class="p">):</span>
                    <span class="n">fp</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="s">{0:12.6f} {1:12.6f} {2:12.6f}</span><span class="se">\n</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">))</span>

    <span class="n">subprocess</span><span class="p">.</span><span class="nf">check_call</span><span class="p">([</span><span class="sh">'</span><span class="s">orca_vpot</span><span class="sh">'</span><span class="p">,</span> <span class="n">basename</span> <span class="o">+</span> <span class="sh">'</span><span class="s">.gbw</span><span class="sh">'</span><span class="p">,</span> <span class="n">basename</span> <span class="o">+</span> <span class="sh">'</span><span class="s">.scfp</span><span class="sh">'</span><span class="p">,</span>
            <span class="n">basename</span> <span class="o">+</span> <span class="sh">'</span><span class="s">_mep.inp</span><span class="sh">'</span><span class="p">,</span> <span class="n">basename</span> <span class="o">+</span> <span class="sh">'</span><span class="s">_mep.out</span><span class="sh">'</span><span class="p">])</span>

    <span class="n">vpot</span> <span class="o">=</span> <span class="nf">read_vpot</span><span class="p">(</span><span class="n">basename</span> <span class="o">+</span> <span class="sh">'</span><span class="s">_mep.out</span><span class="sh">'</span><span class="p">)</span>

    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">basename</span> <span class="o">+</span> <span class="sh">'</span><span class="s">_mep.cube</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">fp</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="s">Generated with ORCA</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">fp</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="s">Electrostatic potential for </span><span class="sh">'</span> <span class="o">+</span> <span class="n">basename</span> <span class="o">+</span> <span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">fp</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="s">{0:5d}{1:12.6f}{2:12.6f}{3:12.6f}</span><span class="se">\n</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span>
            <span class="nf">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">),</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">zmin</span><span class="p">))</span>
        <span class="n">fp</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="s">{0:5d}{1:12.6f}{2:12.6f}{3:12.6f}</span><span class="se">\n</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span>
            <span class="n">npoints</span><span class="p">,</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span> <span class="o">/</span> <span class="nf">float</span><span class="p">(</span><span class="n">npoints</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
        <span class="n">fp</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="s">{0:5d}{1:12.6f}{2:12.6f}{3:12.6f}</span><span class="se">\n</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span>
            <span class="n">npoints</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">)</span> <span class="o">/</span> <span class="nf">float</span><span class="p">(</span><span class="n">npoints</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">))</span>
        <span class="n">fp</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="s">{0:5d}{1:12.6f}{2:12.6f}{3:12.6f}</span><span class="se">\n</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span>
            <span class="n">npoints</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="n">zmax</span> <span class="o">-</span> <span class="n">zmin</span><span class="p">)</span> <span class="o">/</span> <span class="nf">float</span><span class="p">(</span><span class="n">npoints</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">atoms</span><span class="p">):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">elements</span><span class="p">.</span><span class="nf">index</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
            <span class="n">fp</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="s">{0:5d}{1:12.6f}{2:12.6f}{3:12.6f}{4:12.6f}</span><span class="se">\n</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span>
                <span class="n">index</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">ang_to_au</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">ang_to_au</span><span class="p">,</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">ang_to_au</span><span class="p">))</span>

        <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">vpot</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">vpot</span><span class="p">,</span> <span class="p">(</span><span class="n">npoints</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">npoints</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">npoints</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">iy</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">npoints</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">iz</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">npoints</span><span class="p">):</span>
                    <span class="n">fp</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="s">{0:14.5e}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">vpot</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="n">iy</span><span class="p">][</span><span class="n">iz</span><span class="p">]))</span>
                    <span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="nf">if </span><span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">):</span>
                        <span class="n">fp</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
                        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">fp</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
</pre></table></code></div></div><p>The script can be run just using <code class="language-plaintext highlighter-rouge">python mep.py basename npoints</code> (like the example below):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python mep.py water 100
</pre></table></code></div></div><p>The script will use <strong>orca_vpot</strong> for you, (yes, you need to have ORCA installed) and do all the hard lifting, generating the potential surfaces in 2 files, a .cube and a .out. Looking at the .out file, the potentials that you can use to map against any surface is the 4th column. I’ve found that using the .out file is kind of difficult (at least for me) but the .cube works perfectly in conjunction with the electronic density.</p><p>Let me show you how to use UCSF Chimera to see the MEP generated by ORCA then.</p><p>I’m assuming that you already used the python script to get the potentials. Now you must use <strong>orca_plot</strong> to generate the electron density. For example, running:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>orca_plot Water.gbw <span class="nt">-i</span>
</pre></table></code></div></div><p>Select, sequentially, options <strong>1</strong> (<em>Enter type of plot</em>), <strong>2</strong> (<em>(scf) electron density</em>), <strong>4</strong> (<em>Enter number of grid intervals</em>), 120, <strong>5</strong> (<em>Select output file format</em>), <strong>7</strong> (<em>3D   Gaussian cube</em>), <strong>10</strong> (<em>Plot</em>), <strong>11 (</strong><em>Exit</em><strong>)</strong>. You will get something like Water.eldens.cube.</p><p>Now you can use Chimera to open the XYZ file and the electron density going to Tools à Volume Data à Volume Viewer à File à Open map… à Water.eldens.cube. Then go to Tools à Surface Color and select by “electrostatic potential”. In “Potential file” browse to Water_mep.cube that was generated by the python script. Choose your coloring scheme if you want by looking into “Options” and when you are done press “Color”. That is it!</p><iframe class="embed-video youtube" loading="lazy" src="https://www.youtube.com/embed/TGU2nttTKrs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/orca/">ORCA</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/plot/" class="post-tag no-text-decoration" >plot</a> <a href="/tags/bash/" class="post-tag no-text-decoration" >bash</a> <a href="/tags/hint/" class="post-tag no-text-decoration" >hint</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Plotting%20molecular%20electrostatic%20potential%20surfaces%20(MEPS)%20with%20ORCA%20-%20Henrique's%20Blog&url=https%3A%2F%2Fhenriquecsj.github.io%2Fposts%2Fplot-mecp-orca%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Plotting%20molecular%20electrostatic%20potential%20surfaces%20(MEPS)%20with%20ORCA%20-%20Henrique's%20Blog&u=https%3A%2F%2Fhenriquecsj.github.io%2Fposts%2Fplot-mecp-orca%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fhenriquecsj.github.io%2Fposts%2Fplot-mecp-orca%2F&text=Plotting%20molecular%20electrostatic%20potential%20surfaces%20(MEPS)%20with%20ORCA%20-%20Henrique's%20Blog" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/how-can-spin-orbit-coupling/">How can Spin-Orbit Coupling allow interactions between states with different multiplicities?</a><li class="text-truncate lh-lg"> <a href="/posts/plot-mecp-orca/">Plotting molecular electrostatic potential surfaces (MEPS) with ORCA</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/bash/">bash</a> <a class="post-tag btn btn-outline-primary" href="/tags/hint/">hint</a> <a class="post-tag btn btn-outline-primary" href="/tags/notekeeping/">notekeeping</a> <a class="post-tag btn btn-outline-primary" href="/tags/plot/">plot</a> <a class="post-tag btn btn-outline-primary" href="/tags/quantum-mechanics/">quantum mechanics</a> <a class="post-tag btn btn-outline-primary" href="/tags/soc/">soc</a></div></section></div></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/how-can-spin-orbit-coupling/" class="btn btn-outline-primary" aria-label="Older" ><p>How can Spin-Orbit Coupling allow interactions between states with different multiplicities?</p></a><div class="btn btn-outline-primary disabled" aria-label="Newer"><p>-</p></div></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p> © <time>2024</time> <a href="https://mathstodon.xyz/@hcs">Henrique C. S. Junior</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/bash/">bash</a> <a class="post-tag btn btn-outline-primary" href="/tags/hint/">hint</a> <a class="post-tag btn btn-outline-primary" href="/tags/notekeeping/">notekeeping</a> <a class="post-tag btn btn-outline-primary" href="/tags/plot/">plot</a> <a class="post-tag btn btn-outline-primary" href="/tags/quantum-mechanics/">quantum mechanics</a> <a class="post-tag btn btn-outline-primary" href="/tags/soc/">soc</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
